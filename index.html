<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mario cell Phone</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <main class="main-container">
        <div class="products-container">
            <h1>Mario cell Phone</h1>
            
            <h2>Apple - iPhone y Accesorios</h2>
            <div class="producto">
                <h3>IPHONE 16 PROMAX</h3>
                <img src="Iphone 16 promax.jpeg" alt="iPhone 16 Pro Max" width="150">
                <p>Precio: $1350</p>
                <input type="number" id="cantidad_iphone16promax" value="1" min="1">
                <button onclick="agregarAlCarrito('IPHONE 16 PROMAX', 1350, 'cantidad_iphone16promax')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <h3>IPHONE 16 PRO</h3>
                <img src="Iphone 16pro.jpeg" alt="iPhone 16 Pro" width="150">
                <p>Precio: $1100</p>
                <input type="number" id="cantidad_iphone16pro" value="1" min="1">
                <button onclick="agregarAlCarrito('IPHONE 16 PRO', 1100, 'cantidad_iphone16pro')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <h3>IPHONE 16</h3>
                <img src="Iphone 16.jpeg" alt="iPhone 16" width="150">
                <p>Precio: $950</p>
                <input type="number" id="cantidad_iphone16" value="1" min="1">
                <button onclick="agregarAlCarrito('IPHONE 16', 950, 'cantidad_iphone16')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <h3>AURICULARES AIRPODS PRO</h3>
                <img src="Airpods Pro 2.jpeg" alt="Auriculares Airpods Pro" width="150">
                <p>Precio: $230</p>
                <input type="number" id="cantidad_airpodspro" value="1" min="1">
                <button onclick="agregarAlCarrito('AURICULARES AIRPODS PRO', 230, 'cantidad_airpodspro')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <h3>CARGADOR ORIGINAL IPHONE</h3>
                <img src="Cargador Iphone.jpeg" alt="Cargador original iPhone" width="150">
                <p>Precio: $50</p>
                <input type="number" id="cantidad_cargadoriphone" value="1" min="1">
                <button onclick="agregarAlCarrito('CARGADOR ORIGINAL IPHONE', 50, 'cantidad_cargadoriphone')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <h3>CABLE USB IPHONE 16</h3>
                <img src="Usb cable iphone.jpeg" alt="Cable USB para iPhone 16" width="150">
                <p>Precio: $35</p>
                <input type="number" id="cantidad_cableiphone" value="1" min="1">
                <button onclick="agregarAlCarrito('CABLE USB IPHONE 16', 35, 'cantidad_cableiphone')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <h3>AURICULARES IPHONE</h3>
                <img src="AURICULARES-IPHONE.jpeg" alt="Auriculares iPhone" width="150">
                <p>Precio: $60</p>
                <input type="number" id="cantidad_auricularesiphone" value="1" min="1">
                <button onclick="agregarAlCarrito('AURICULARES IPHONE', 60, 'cantidad_auricularesiphone')">Agregar al carrito</button>
            </div>
            <br>
            
            <h2>Samsung - Smartphones y Accesorios</h2>
            <div class="producto">
                <h3>SAMSUNG S25</h3>
                <img src="Sansung s25 Ultra.jpeg" alt="Samsung S25 Ultra" width="150">
                <p>Precio: $1350</p>
                <input type="number" id="cantidad_samsungs25" value="1" min="1">
                <button onclick="agregarAlCarrito('SAMSUNG S25', 1350, 'cantidad_samsungs25')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <h3>SAMSUNG S24</h3>
                <img src="Sansung s24 Ultra.jpeg" alt="Samsung S24 Ultra" width="150">
                <p>Precio: $100</p>
                <input type="number" id="cantidad_samsungs24" value="1" min="1">
                <button onclick="agregarAlCarrito('SAMSUNG S24', 100, 'cantidad_samsungs24')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <h3>CARGADOR SAMSUNG</h3>
                <img src="Cargador Sansung Original.jpeg" alt="Cargador Samsung original" width="150">
                <p>Precio: $40</p>
                <input type="number" id="cantidad_cargadorsamsung" value="1" min="1">
                <button onclick="agregarAlCarrito('CARGADOR SAMSUNG', 40, 'cantidad_cargadorsamsung')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <h3>CABLE USB SAMSUNG</h3>
                <img src="Usb cable Sansung.jpeg" alt="Cable USB Samsung" width="150">
                <p>Precio: $30</p>
                <input type="number" id="cantidad_cablesamsung" value="1" min="1">
                <button onclick="agregarAlCarrito('CABLE USB SAMSUNG', 30, 'cantidad_cablesamsung')">Agregar al carrito</button>
            </div>
            <div class="producto">
                <h3>AURICULARES SAMSUNG</h3>
                <img src="Sansung Galay bud 3.jpeg" alt="Auriculares Samsung Galaxy Buds 3" width="150">
                <p>Precio: $50</p>
                <input type="number" id="cantidad_auricularessamsung" value="1" min="1">
                <button onclick="agregarAlCarrito('AURICULARES SAMSUNG', 50, 'cantidad_auricularessamsung')">Agregar al carrito</button>
            </div>
        </div>

        <div class="sidebar-container">
            <div class="login-box">
                <h2>Registro / Inicio de Sesión</h2>
                <div class="login-options">
                    <button id="show-login">Iniciar Sesión</button>
                    <button id="show-register">Registrarse</button>
                </div>
                <form id="register-form">
                    <h3>Formulario de Registro</h3>
                    <input type="text" id="nombre-usuario" placeholder="Nombre" required>
                    <input type="text" placeholder="Apellido" required>
                    <input type="tel" placeholder="Número de teléfono" required>
                    <input type="email" placeholder="Correo electrónico" required>
                    <input type="date" placeholder="Fecha de Nacimiento">
                    <button type="submit">Registrar</button>
                </form>
                <form id="login-form" style="display: none;">
                    <h3>Inicio de Sesión</h3>
                    <input type="email" placeholder="Correo electrónico" required>
                    <input type="password" placeholder="Contraseña" required>
                    <button type="submit">Entrar</button>
                </form>
            </div>

            <div id="carrito" class="carrito-box">
                <h2>Carrito de Compras</h2>
                <p>Total de productos: <span id="totalProductos">0</span></p>
                <ul id="listaCarrito"></ul>
                <p><strong>Total a pagar:</strong> $<span id="total">0</span></p>
                <div class="payment-options">
                    <h3>Método de pago</h3>
                    <input type="radio" id="pago_efectivo" name="metodo_pago" value="Efectivo" checked>
                    <label for="pago_efectivo">Efectivo</label><br>
                    <input type="radio" id="pago_tarjeta" name="metodo_pago" value="Tarjeta de crédito">
                    <label for="pago_tarjeta">Tarjeta de crédito</label><br>
                </div>
                <button onclick="finalizarCompra()">Finalizar Compra</button>
                <button onclick="vaciarCarrito()">Vaciar carrito</button>
            </div>
            
            <div id="historial" class="historial-box">
                <h2>Historial de Compras</h2>
                <ul id="listaHistorial"></ul>
            </div>
        </div>
    </main>

    <button id="theme-toggle" class="theme-toggle-btn">Cambiar Tema</button>

    <script>
        function agregarAlCarrito(nombre, precio, idCantidad) {
            const cantidad = parseInt(document.getElementById(idCantidad).value, 10);
            if (cantidad > 0) {
                const carrito = JSON.parse(localStorage.getItem('carrito')) || [];
                
                const itemExistente = carrito.find(item => item.nombre === nombre);
                if (itemExistente) {
                    itemExistente.cantidad += cantidad;
                } else {
                    carrito.push({ nombre, precio, cantidad });
                }
                localStorage.setItem('carrito', JSON.stringify(carrito));
                mostrarCarrito();
            }
        }

        function mostrarCarrito() {
            const carrito = JSON.parse(localStorage.getItem('carrito')) || [];
            const lista = document.getElementById('listaCarrito');
            const totalElem = document.getElementById('total');
            const totalProductosElem = document.getElementById('totalProductos');
            lista.innerHTML = '';
            let total = 0;
            let totalProductos = 0;
            carrito.forEach((item) => {
                const li = document.createElement('li');
                li.textContent = `${item.nombre} - $${item.precio} x ${item.cantidad}`;
                lista.appendChild(li);
                total += item.precio * item.cantidad;
                totalProductos += item.cantidad;
            });
            totalElem.textContent = total.toFixed(2);
            totalProductosElem.textContent = totalProductos;
        }

        function restablecerCantidades() {
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.value = 1;
            });
        }
        
        function vaciarCarrito() {
            localStorage.removeItem('carrito');
            mostrarCarrito();
            restablecerCantidades();
        }

        function finalizarCompra() {
            const carrito = JSON.parse(localStorage.getItem('carrito')) || [];
            if (carrito.length > 0) {
                const historial = JSON.parse(localStorage.getItem('historialCompras')) || [];
                
                const nombreUsuario = localStorage.getItem('nombreUsuario') || 'Anónimo';
                const metodoPago = document.querySelector('input[name="metodo_pago"]:checked').value;
                
                const nuevaCompra = {
                    fecha: new Date().toLocaleString(),
                    nombre: nombreUsuario,
                    metodoPago: metodoPago,
                    productos: carrito,
                    total: carrito.reduce((sum, item) => sum + item.precio * item.cantidad, 0)
                };
                historial.push(nuevaCompra);
                localStorage.setItem('historialCompras', JSON.stringify(historial));
                mostrarHistorial();
                alert('¡Gracias por tu compra! Tu pedido ha sido procesado.');
                vaciarCarrito();
            } else {
                alert('El carrito está vacío. Agrega productos para finalizar la compra.');
            }
        }
        
        function mostrarHistorial() {
            const historial = JSON.parse(localStorage.getItem('historialCompras')) || [];
            const lista = document.getElementById('listaHistorial');
            lista.innerHTML = '';
            historial.forEach((compra) => {
                const li = document.createElement('li');
                const detallesCompra = compra.productos.map(item => `${item.nombre} (${item.cantidad})`).join(', ');
                li.innerHTML = `<strong>Comprador:</strong> ${compra.nombre}<br>
                                <strong>Fecha:</strong> ${compra.fecha}<br>
                                <strong>Método de pago:</strong> ${compra.metodoPago}<br>
                                <strong>Productos:</strong> ${detallesCompra}<br>
                                <strong>Total:</strong> $${compra.total.toFixed(2)}`;
                lista.appendChild(li);
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            mostrarCarrito();
            mostrarHistorial();

            const themeToggle = document.getElementById('theme-toggle');
            const body = document.body;
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                body.classList.add(savedTheme);
            }
            themeToggle.addEventListener('click', () => {
                body.classList.toggle('dark-mode');
                if (body.classList.contains('dark-mode')) {
                    localStorage.setItem('theme', 'dark-mode');
                } else {
                    localStorage.removeItem('theme');
                }
            });
            
            const showLoginBtn = document.getElementById('show-login');
            const showRegisterBtn = document.getElementById('show-register');
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');

            // Nueva funcionalidad: Guardar el nombre al registrarse
            registerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const nombreUsuario = document.getElementById('nombre-usuario').value;
                if (nombreUsuario) {
                    localStorage.setItem('nombreUsuario', nombreUsuario);
                    alert(`¡Bienvenido, ${nombreUsuario}! Tu registro ha sido simulado.`);
                }
            });

            showLoginBtn.addEventListener('click', () => {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
            });
            showRegisterBtn.addEventListener('click', () => {
                registerForm.style.display = 'block';
                loginForm.style.display = 'none';
            });
        });
    </script>
</body>
</html>
